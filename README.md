# About KAITOPIA

## 用語

- ユーザ ... このアプリを使用できる対象
- ユーザロール ... ユーザの種類 [here](#ユーザロール)
- スクール ... ユーザが所属している区分 [here](#スクール)
  - セルフスクール ... ユーザがデフォルトで所属しているスクール
- 問題 ... テストの各問題
- テスト ... 1 つ以上の問題の集まり

## 機能

### ユーザ管理

Firebase Auth を使った認証機能を実装する。

#### ユーザロール

ユーザはいずれかのユーザロールを持つ。

| role      | explain                                |
| --------- | -------------------------------------- |
| USER      | アカウントを作成した時のデフォルト     |
| MODERATOR | 問題とテストを作成し自分で利用できる   |
| TEACHER   | 問題とテストを作成し全体に公開できる　 |
| ADMIN     | 開発者(最上位権限を持つロール)         |

#### スクール

ユーザを作成すると、固有のスクール(セルフスクール)が作成される。

TEACHER 以上のロールを持つユーザは 2 つ以上のスクールを作成(最大 5 つ)できる。

問題とテストは、いずれかのスクールに所属している。

### テスト

テストは下記のデータ構造を持つ。

```plain
テスト1
 - 問題A
 - 問題B
 - 問題C
テスト2
 - 問題B // 別のテストに設定している問題をコピーできる
 - 問題D
 - 問題E
```

#### 問題種類

問題は、下記の種類の出題、回答形式がある

- 出題
  - 文章題（短文）
  - 文章題（長文） ... 1.1.0 リリース
- 回答
  - 選択式（単一、複数）

## ページ

### パス

```plain
(root)/ ... トップページ (LP)
  p/ ...
    login/
    signup/
  user/ ... ログイン後のトップページ
  manage/ ... 管理者用のトップページ (MODERATOR以上のユーザがアクセスできる)
```

## 開発

### ブランチルール

- main ... production ブランチ
- develop ... 次回リリースブランチ (main からの派生)
- (IssueNo)-(fix|refactor)/(label) ... 修正ブランチ (develop からの派生)

### CI/CD

#### テスト実行

Github Actions にて、PR 単位で自動テストを実行する。
テストが全て成功しなければ、PR をマージできない。

#### リリース

main へ `cX.X.X` 形式のタグがプッシュされたタイミングで、DB マイグレーションを行い、GCP へのリリースを行う。
